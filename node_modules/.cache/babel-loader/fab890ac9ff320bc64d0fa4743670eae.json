{"ast":null,"code":"var _jsxFileName = \"/Users/mckelvie/Desktop/spotify-w-friends/cs4550-project-main 2/src/components/FollowButton/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport * as service from \"../../services/user-service\";\nimport { useProfile } from \"../../contexts/profileContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst FollowButton = _ref => {\n  _s();\n\n  let {\n    user = {\n      _id: '0',\n      name: 'bill',\n      username: 'bill-webdev',\n      password: 'p@ssword',\n      creator: false,\n      biography: 'hello',\n      image: '',\n      songs: [],\n      playlists: [],\n      followers: [],\n      following: []\n    },\n    className = ''\n  } = _ref;\n  const [followingUser, setFollowingUser] = useState(false);\n  const btnStyle = `w-auto btn btn-secondary ${className}`;\n  const [otherUser, setOtherUser] = useState(user);\n  const [currentUser, setCurrentUser] = useState();\n  const {\n    checkLoggedIn,\n    updateCurrentUser\n  } = useProfile();\n  useEffect(() => {\n    const check = async () => {\n      try {\n        const user = await checkLoggedIn();\n        setCurrentUser(user);\n      } catch (e) {\n        console.log(`Unable to run checkLoggedIn in FollowButton index.js: ${e}`);\n      }\n    };\n\n    check();\n  }, []);\n  useEffect(() => {\n    // Update initial state of follow user reducer value\n    if (currentUser) {\n      setFollowingUser(currentUser.following.includes(otherUser._id));\n    }\n  }, [currentUser]);\n\n  const handleClick = () => {\n    if (followingUser) {\n      unfollow();\n    } else {\n      follow();\n    }\n  };\n\n  const follow = async () => {\n    try {\n      const updateLoggedInUser = async () => {\n        currentUser.following.push(otherUser._id); // Below is to trigger the useEffect for currentUser\n\n        const updatedUser = { ...currentUser,\n          following: currentUser.following\n        };\n        await updateCurrentUser(updatedUser);\n        setCurrentUser(updatedUser);\n      };\n\n      const updateOtherUser = async () => {\n        otherUser.followers.push(currentUser._id);\n        await service.updateUser(otherUser);\n        setOtherUser(otherUser);\n      };\n\n      const perform = async () => {\n        await Promise.all([updateLoggedInUser(), updateOtherUser(), setFollowingUser(true)]);\n      };\n\n      perform();\n    } catch (e) {\n      console.log(`In FollowButton index.js, unable to perform follow functionality: ${e}`);\n    }\n  };\n\n  const unfollow = () => {\n    try {\n      const updateLoggedInUser = async () => {\n        const updatedUser = { ...currentUser,\n          following: currentUser.following.filter(id => id !== otherUser._id)\n        };\n        const updated = await updateCurrentUser(updatedUser);\n        setCurrentUser(updated);\n      };\n\n      const updateOtherUser = async () => {\n        const updatedUser = { ...otherUser,\n          followers: otherUser.followers.filter(id => id !== currentUser._id)\n        };\n        await service.updateUser(updatedUser);\n        setOtherUser(otherUser);\n      };\n\n      const perform = async () => {\n        await Promise.all([updateLoggedInUser(), updateOtherUser(), setFollowingUser(false)]);\n      };\n\n      perform();\n    } catch (e) {\n      console.log(`In FollowButton index.js, unable to perform follow functionality: ${e}`);\n    }\n  };\n\n  if (currentUser && currentUser._id !== otherUser._id) {\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      className: btnStyle,\n      onClick: handleClick,\n      children: followingUser && 'Unfollow' || 'Follow'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 13\n    }, this);\n  }\n\n  return null;\n};\n\n_s(FollowButton, \"zl4PQi1ErhCRnMnMSha8CRVrWNs=\", false, function () {\n  return [useProfile];\n});\n\n_c = FollowButton;\nexport default FollowButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"FollowButton\");","map":{"version":3,"sources":["/Users/mckelvie/Desktop/spotify-w-friends/cs4550-project-main 2/src/components/FollowButton/index.js"],"names":["React","useEffect","useState","service","useProfile","FollowButton","user","_id","name","username","password","creator","biography","image","songs","playlists","followers","following","className","followingUser","setFollowingUser","btnStyle","otherUser","setOtherUser","currentUser","setCurrentUser","checkLoggedIn","updateCurrentUser","check","e","console","log","includes","handleClick","unfollow","follow","updateLoggedInUser","push","updatedUser","updateOtherUser","updateUser","perform","Promise","all","filter","id","updated"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport * as service from \"../../services/user-service\";\nimport { useProfile } from \"../../contexts/profileContext\";\n\nconst FollowButton = ({user = {\n    _id: '0',\n    name: 'bill',\n    username: 'bill-webdev',\n    password: 'p@ssword',\n    creator: false,\n    biography: 'hello',\n    image: '',\n    songs: [],\n    playlists: [],\n    followers: [],\n    following: [],\n}, className=''}) => {\n    const [followingUser, setFollowingUser] = useState(false);\n    const btnStyle = `w-auto btn btn-secondary ${className}`;\n    const [otherUser, setOtherUser] = useState(user);\n    const [currentUser, setCurrentUser] = useState();\n    const { checkLoggedIn, updateCurrentUser } = useProfile();\n\n    useEffect(() => {\n        const check = async () => {\n            try {\n                const user = await checkLoggedIn();\n                setCurrentUser(user);\n            } catch (e) {\n                console.log(`Unable to run checkLoggedIn in FollowButton index.js: ${e}`);\n            }\n        }\n        check();\n    }, []);\n\n    useEffect(() => {\n        // Update initial state of follow user reducer value\n        if (currentUser) {\n            setFollowingUser(currentUser.following.includes(otherUser._id));\n        }\n    }, [currentUser]);\n\n    const handleClick = () => {\n        if (followingUser) {\n            unfollow();\n        } else {\n            follow();\n        }\n    };\n\n    const follow = async () => {\n        try {\n            const updateLoggedInUser = async () => {\n                currentUser.following.push(otherUser._id);\n                // Below is to trigger the useEffect for currentUser\n                const updatedUser = {\n                    ...currentUser,\n                    following: currentUser.following\n                }\n                await updateCurrentUser(updatedUser);\n                setCurrentUser(updatedUser);\n            };\n            const updateOtherUser = async () => {\n                otherUser.followers.push(currentUser._id);\n                await service.updateUser(otherUser);\n                setOtherUser(otherUser);\n            };\n            const perform = async () => {\n                await Promise.all([\n                    updateLoggedInUser(),\n                    updateOtherUser(),\n                    setFollowingUser(true)\n                ]);\n            };\n            perform();\n        } catch (e) {\n            console.log(`In FollowButton index.js, unable to perform follow functionality: ${e}`);\n        }\n    };\n\n    const unfollow = () => {\n        try {\n            const updateLoggedInUser = async () => {\n                const updatedUser = {\n                    ...currentUser,\n                    following: currentUser.following.filter(id => id !== otherUser._id)\n                };\n                const updated = await updateCurrentUser(updatedUser);\n                setCurrentUser(updated);\n            };\n            const updateOtherUser = async () => {\n                const updatedUser = { \n                    ...otherUser,\n                    followers: otherUser.followers.filter(id => id !== currentUser._id)\n                };\n                await service.updateUser(updatedUser);\n                setOtherUser(otherUser);\n            };\n            const perform = async () => {\n                await Promise.all([\n                    updateLoggedInUser(),\n                    updateOtherUser(),\n                    setFollowingUser(false)\n                ]);\n            };\n            perform();\n        } catch (e) {\n            console.log(`In FollowButton index.js, unable to perform follow functionality: ${e}`);\n        }\n    };\n\n    if (currentUser && currentUser._id !== otherUser._id) {\n        return (\n            <button className={btnStyle} onClick={handleClick}>\n                {(followingUser && 'Unfollow') || 'Follow'}\n            </button>\n        );\n    }\n\n    return null;\n};\n\nexport default FollowButton;"]},"metadata":{},"sourceType":"module"}